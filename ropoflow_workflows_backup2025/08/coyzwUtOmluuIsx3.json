{
  "active": false,
  "connections": {
    "obtener todas las oportunidades": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Comercial",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Telemercadeo",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Admin latam",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Admin Australia",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Tourist Visa Latam",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Student Support",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Limpieza data do not use",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Oportunidades que no hacen match",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Comercial": {
      "main": [
        [
          {
            "node": "Encontrar el stage id",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Telemercadeo": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Admin latam": {
      "main": [
        [
          {
            "node": "Encontrar el stage id 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Admin Australia": {
      "main": [
        [
          {
            "node": "Encontrar el stage id 3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Tourist Visa Latam": {
      "main": [
        [
          {
            "node": "Encontrar el stage id 4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Student Support": {
      "main": [
        [
          {
            "node": "Encontrar el stage id 5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Limpieza data do not use": {
      "main": [
        [
          {
            "node": "Encontrar el stage id 6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "buscar oportunidades": {
      "main": [
        [
          {
            "node": "obtener todas las oportunidades",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "obtener token",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get many contacts12": {
      "main": [
        [
          {
            "node": "guardar oportunidad2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Encontrar el stage id": {
      "main": [
        [
          {
            "node": "encontrar el custom field",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "encontrar el custom field": {
      "main": [
        [
          {
            "node": "obtener id contact clientify",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "encontrar el custom field1": {
      "main": [
        [
          {
            "node": "obtener id contact clientify2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Encontrar el stage id 2": {
      "main": [
        [
          {
            "node": "encontrar el custom field1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "encontrar el custom field2": {
      "main": [
        [
          {
            "node": "obtener id contact clientify1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "encontrar el custom field2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "encontrar el custom field3": {
      "main": [
        [
          {
            "node": "obtener id contact clientify3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Encontrar el stage id 3": {
      "main": [
        [
          {
            "node": "encontrar el custom field3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "encontrar el custom field4": {
      "main": [
        [
          {
            "node": "obtener id contact clientify4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Encontrar el stage id 4": {
      "main": [
        [
          {
            "node": "encontrar el custom field4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "obtener id contact clientify": {
      "main": [
        [
          {
            "node": "Select rows from a table",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Select rows from a table": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Get a contact",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get many contacts12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get a contact": {
      "main": [
        [
          {
            "node": "guardar oportunidad2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "obtener id contact clientify1": {
      "main": [
        [
          {
            "node": "Select rows from a table1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Select rows from a table1": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Get a contact1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get many contacts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get a contact1": {
      "main": [
        [
          {
            "node": "guardar oportunidad1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get many contacts": {
      "main": [
        [
          {
            "node": "guardar oportunidad1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "obtener id contact clientify2": {
      "main": [
        [
          {
            "node": "Select rows from a table2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Select rows from a table2": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If2": {
      "main": [
        [
          {
            "node": "Get a contact2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get many contacts13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get a contact2": {
      "main": [
        [
          {
            "node": "guardar oportunidad",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get many contacts13": {
      "main": [
        [
          {
            "node": "guardar oportunidad",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "obtener id contact clientify3": {
      "main": [
        [
          {
            "node": "Select rows from a table3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Select rows from a table3": {
      "main": [
        [
          {
            "node": "If3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If3": {
      "main": [
        [
          {
            "node": "Get a contact3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get many contacts14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get a contact3": {
      "main": [
        [
          {
            "node": "guardar oportunidad3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get many contacts14": {
      "main": [
        [
          {
            "node": "guardar oportunidad3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "obtener id contact clientify4": {
      "main": [
        [
          {
            "node": "Select rows from a table4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Select rows from a table4": {
      "main": [
        [
          {
            "node": "If4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If4": {
      "main": [
        [
          {
            "node": "Get a contact4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get many contacts15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get a contact4": {
      "main": [
        [
          {
            "node": "guardar oportunidad4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get many contacts15": {
      "main": [
        [
          {
            "node": "guardar oportunidad4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "encontrar el custom field5": {
      "main": [
        [
          {
            "node": "obtener id contact clientify5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "obtener id contact clientify5": {
      "main": [
        [
          {
            "node": "Select rows from a table5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Select rows from a table5": {
      "main": [
        [
          {
            "node": "If5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If5": {
      "main": [
        [
          {
            "node": "Get a contact5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get many contacts16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get a contact5": {
      "main": [
        [
          {
            "node": "guardar oportunidad5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get many contacts16": {
      "main": [
        [
          {
            "node": "guardar oportunidad5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Encontrar el stage id 5": {
      "main": [
        [
          {
            "node": "encontrar el custom field5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "encontrar el custom field6": {
      "main": [
        [
          {
            "node": "obtener id contact clientify6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get many contacts17": {
      "main": [
        [
          {
            "node": "guardar oportunidad6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "obtener id contact clientify6": {
      "main": [
        [
          {
            "node": "Select rows from a table6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Select rows from a table6": {
      "main": [
        [
          {
            "node": "If6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If6": {
      "main": [
        [
          {
            "node": "Get a contact6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get many contacts17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get a contact6": {
      "main": [
        [
          {
            "node": "guardar oportunidad6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Encontrar el stage id 6": {
      "main": [
        [
          {
            "node": "encontrar el custom field6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "juntar todas las oportunidades12": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "juntar todas las oportunidades1": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "juntar todas las oportunidades": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "juntar todas las oportunidades2": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "juntar todas las oportunidades4": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "juntar todas las oportunidades5": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "juntar todas las oportunidades6": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "obtener token": {
      "main": [
        [
          {
            "node": "buscar oportunidades",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "guardar oportunidad": {
      "main": [
        [
          {
            "node": "juntar todas las oportunidades",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "guardar oportunidad1": {
      "main": [
        [
          {
            "node": "juntar todas las oportunidades1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "guardar oportunidad2": {
      "main": [
        [
          {
            "node": "juntar todas las oportunidades12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "guardar oportunidad3": {
      "main": [
        [
          {
            "node": "juntar todas las oportunidades2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "guardar oportunidad4": {
      "main": [
        [
          {
            "node": "juntar todas las oportunidades4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "guardar oportunidad5": {
      "main": [
        [
          {
            "node": "juntar todas las oportunidades5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "guardar oportunidad6": {
      "main": [
        [
          {
            "node": "juntar todas las oportunidades6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-08-19T20:35:54.756Z",
  "id": "coyzwUtOmluuIsx3",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Sincronizar oportunidades",
  "nodes": [
    {
      "parameters": {
        "jsCode": "let allOppo = [];\n\nfor (const page of $input.all()) {\n  // page.json.contacts es un array de contactos\n  allOppo.push(...page.json.results); // agregamos todos los contactos al array\n}\n\n// Devolverlos como items de n8n\nreturn allOppo.map(opportunitie => ({ json: opportunitie }));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        300,
        980
      ],
      "id": "6cf1ec65-59a3-4d19-ba05-d624a9d505ee",
      "name": "obtener todas las oportunidades"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.pipeline_desc }}",
                    "rightValue": "Comercial",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "551f8352-0c38-481d-9427-14a8c4ab6e97"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "3e2eab53-4e35-4389-b3d7-69831eea07a1",
                    "leftValue": "={{ $json.pipeline_desc }}",
                    "rightValue": "Telemercadeo",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "080d2005-3757-4227-a200-98bfa300a1de",
                    "leftValue": "={{ $json.pipeline_desc }}",
                    "rightValue": "Admin Latam",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "1d9c5995-bac6-48f1-acb3-32ce7cb70d59",
                    "leftValue": "={{ $json.pipeline_desc }}",
                    "rightValue": "Admin Australia",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "33347896-88dd-4d86-87b1-a9f7d819c154",
                    "leftValue": "={{ $json.pipeline_desc }}",
                    "rightValue": "Tourist Visa Latam",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "10ee34e0-84e3-4a64-9d3e-5a1d3e90fd72",
                    "leftValue": "={{ $json.pipeline_desc }}",
                    "rightValue": "Student Support",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "f116455b-a06b-4d69-8717-f6e512839ed6",
                    "leftValue": "={{ $json.pipeline_desc }}",
                    "rightValue": "Limpieza data do not use",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        520,
        880
      ],
      "id": "85b0337d-03e9-411b-b248-eada97cda3b2",
      "name": "Switch"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "16d97703-fc83-4e52-b4cc-3a94f0d209a1",
              "name": "pipeline",
              "value": "=6NXiP07lsEXQ7ubkBamK",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        740,
        780
      ],
      "id": "d7802ecf-8c10-486c-8393-0482fdb35352",
      "name": "Admin Australia",
      "executeOnce": false
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "16d97703-fc83-4e52-b4cc-3a94f0d209a1",
              "name": "pipeline",
              "value": "=7i90m14snYBJ3sn9bfpR",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        740,
        380
      ],
      "id": "ad867598-ac63-4453-9876-083ebb4b1d9d",
      "name": "Admin latam",
      "executeOnce": false
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "16d97703-fc83-4e52-b4cc-3a94f0d209a1",
              "name": "pipeline",
              "value": "=G7XLpzBB9FnFsOWrxala",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        740,
        -20
      ],
      "id": "3819fff3-2cd4-4e6d-91fa-e5b28b21ebe9",
      "name": "Telemercadeo"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "16d97703-fc83-4e52-b4cc-3a94f0d209a1",
              "name": "pipeline",
              "value": "=G7XLpzBB9FnFsOWrxala",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        740,
        -420
      ],
      "id": "b15e396a-2ef6-44f7-9e16-2aa2414c6f09",
      "name": "Comercial"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "16d97703-fc83-4e52-b4cc-3a94f0d209a1",
              "name": "pipeline",
              "value": "=9dCoVqGRX19rK55Q1R45",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        740,
        1180
      ],
      "id": "e1e706f2-48fa-4f78-aae8-a6de61fc8b62",
      "name": "Tourist Visa Latam",
      "executeOnce": false
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "16d97703-fc83-4e52-b4cc-3a94f0d209a1",
              "name": "pipeline",
              "value": "=s88JnIpcrmSfVD2Hp56K",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        740,
        1580
      ],
      "id": "1a1b559a-6b7e-483b-872e-806da8282a65",
      "name": "Student Support"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "16d97703-fc83-4e52-b4cc-3a94f0d209a1",
              "name": "pipeline",
              "value": "=JXm35Mpfo46mJVVb1Sjk",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        740,
        1980
      ],
      "id": "decf473f-3e88-4d17-b0a3-96ff2a10b67a",
      "name": "Limpieza data do not use"
    },
    {
      "parameters": {
        "jsCode": "return $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        740,
        2180
      ],
      "id": "f72a61be-b9d7-41c2-b207-86a15d86187a",
      "name": "Oportunidades que no hacen match"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "fbe6515b-cb4f-40ff-acac-b54dcca5b45f",
              "name": "pipeline_stage",
              "value": "=44ff8a36-886f-40b6-8861-d9b494cb3c70",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        960,
        -20
      ],
      "id": "60e84adc-509d-4d5a-88bb-9cc5ade1e257",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "url": "https://api.clientify.net/v1/deals?page=2",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token 25a30fd463c39611808dd0c8267493734dd0e253"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {
          "redirect": {
            "redirect": {}
          },
          "pagination": {
            "pagination": {
              "paginationMode": "responseContainsNextURL",
              "nextURL": "={{ $response.body.next }}",
              "paginationCompleteWhen": "other",
              "completeExpression": "={{ null }}",
              "limitPagesFetched": true,
              "maxRequests": 1000,
              "requestInterval": 250
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        80,
        980
      ],
      "id": "7d3bf512-b541-46c6-aae0-0e139a5ffed3",
      "name": "buscar oportunidades"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -900,
        980
      ],
      "id": "1706d7ef-f631-4bb3-9943-b460b3511023",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "jsCode": "return $json;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2720,
        -420
      ],
      "id": "b9e12e40-5c89-4bb5-9f3f-41fa61c6be06",
      "name": "juntar todas las oportunidades12"
    },
    {
      "parameters": {
        "operation": "getAll",
        "limit": 1,
        "delayPagination": 500,
        "filters": {
          "query": "={{ $json.contact_phone }}"
        },
        "options": {},
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        -320
      ],
      "id": "7ba5b322-0237-4266-90cd-1c400cf695f5",
      "name": "Get many contacts12",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "9EZZ771fViKZkfUg",
          "name": "Blue studies - App ropoflow"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "let match = {\n  \"Lead Asignado - Latam\" : \"44ff8a36-886f-40b6-8861-d9b494cb3c70\",\n  \"Pendiente en responder - Latam\": \"086a7a8c-9c8f-4983-aac0-feec643c6c99\",\n  \"Cita Agendada - Latam\": \"d889943c-3ac7-4177-a392-c97ff9de243f\",\n  \"Pendiente Re agendar - Latam\": \"aaae7aa8-ac38-4b14-b49a-0d56cbd700c5\",\n  \"Cotización - Latam\": \"7797b41c-bf2b-47cf-b81b-10c91bfb7fd3\",\n  \"Empezar - Un mes - Latam\": \"0f268aaa-a411-48a5-8a0b-d0d1b46c3ca8\",\n  \"Empezar - 3 meses - Latam\": \"3fea3ba8-d7fe-4936-8195-f658940c5ac9\",\n  \"Empezar 6 meses - Latam\": \"7797b41c-bf2b-47cf-b81b-10c91bfb7fd3\",\n  \"empieza 1 año - Latam\": \"7797b41c-bf2b-47cf-b81b-10c91bfb7fd3\",\n  \"Inicio de proceso - Latam\": \"f432d541-d5de-4c13-a72d-a3bd9e8b1b4c\",\n  \"Cobros Pendientes - Latam\": \"6c6c84e6-d84a-446d-be96-c3ba2434b401\",\n  \"Pago en espera de visa - Latam\": \"e011b0b0-c8be-4f54-82e2-ffa014637bee\"\n}\n\n// recorrer los items, mirando su pipeline_stage_desc y comparando\nreturn $input.all().map(item => {\n  let desc = item.json.pipeline_stage_desc;\n  \n  if (match[desc]) {\n    item.json.pipeline_stage = match[desc];\n  } else {\n    // si no hay match, puedes dejarlo nulo o igual al original\n    item.json.pipeline_stage = null;\n  }\n  \n  return item;\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        960,
        -420
      ],
      "id": "f00a10fc-f565-435d-bfab-11074d2b3e82",
      "name": "Encontrar el stage id"
    },
    {
      "parameters": {
        "jsCode": "let match = {\n  \"Cuenta que deposito\": {\n    id: \"mPbI3JvvW2tUAXBHXV9n\",\n    key: \"opportunity.cuenta_que_deposito\"\n  },\n  \"Tipo de aplicación\": {\n    id: \"p7lJUWQtkaoRXlVikvXj\",\n    key: \"opportunity.tipo_de_aplicacin\"\n  }\n};\n\nreturn $input.all().map(item => {\n  let customFields = item.json.custom_fields || [];\n\n  let customFieldsFixed = customFields\n    .filter(cf => match[cf.field]) // solo si hay match\n    .map(cf => {\n      return {\n        id: match[cf.field].id,\n        key: match[cf.field].key,\n        field_value: cf.value\n      };\n    });\n\n  item.json.custom_fields_fixed = customFieldsFixed;\n\n  return item;\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1180,
        -420
      ],
      "id": "03bed7eb-8829-4161-aab4-324bfcf98823",
      "name": "encontrar el custom field"
    },
    {
      "parameters": {
        "jsCode": "let match = {\n  \"Cuenta que deposito\": {\n    id: \"mPbI3JvvW2tUAXBHXV9n\",\n    key: \"opportunity.cuenta_que_deposito\"\n  },\n  \"Tipo de aplicación\": {\n    id: \"p7lJUWQtkaoRXlVikvXj\",\n    key: \"opportunity.tipo_de_aplicacin\"\n  }\n};\n\nreturn $input.all().map(item => {\n  let customFields = item.json.custom_fields || [];\n\n  let customFieldsFixed = customFields\n    .filter(cf => match[cf.field]) // solo si hay match\n    .map(cf => {\n      return {\n        id: match[cf.field].id,\n        key: match[cf.field].key,\n        field_value: cf.value\n      };\n    });\n\n  item.json.custom_fields_fixed = customFieldsFixed;\n\n  return item;\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1180,
        380
      ],
      "id": "5cf61adc-554e-44a0-aeb6-6f948e409c8c",
      "name": "encontrar el custom field1"
    },
    {
      "parameters": {
        "jsCode": "return $json;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2720,
        380
      ],
      "id": "32937cdf-ce42-46c2-8de3-79eace387afa",
      "name": "juntar todas las oportunidades"
    },
    {
      "parameters": {
        "jsCode": "let match = {\n  \"Asignacion- Latam\" : \"cedad6d5-dc90-4368-9082-91293430c394\",\n  \"Contactar estudiante - Latam- Latam\": \"59a9eb69-2a24-4218-b5a4-19d400447ec9\",\n  \"Reunion Documentos Académicos - Latam\": \"54e71d34-624c-4597-81a7-00f3838a0e66\",\n  \"Aplicación a institución - Latam\": \"3d48fd20-691d-4a39-adf3-71557f8fbe8f\",\n  \"LOO - Latam\": \"18e8e41d-9e5d-4f32-b982-c375d36aceca\",\n  \"Pagos - Latam\": \"100ea645-b82c-40e3-b909-aeb84c367e23\",\n  \"COE LOA  - Latam\": \"16fbf31a-b4d1-43b2-870b-25340905a831\",\n  \"Reunion Documentos visa - Latam\": \"24dda578-cea7-43ca-8cf3-9a6a25eced44\",\n  \"Stand by - Latam\": \"58d5127e-5803-463d-bfd8-2fa3da3d0643\",\n  \"Reembolsos - Latam\": \"92688a9c-2f89-495f-a9d6-e9876b4b25f4\",\n  \"Visa Aplicada - Latam\": \"4c1e597d-e4af-48bd-aa5e-41ebde966275\"\n}\n\n// recorrer los items, mirando su pipeline_stage_desc y comparando\nreturn $input.all().map(item => {\n  let desc = item.json.pipeline_stage_desc;\n  \n  if (match[desc]) {\n    item.json.pipeline_stage = match[desc];\n  } else {\n    // si no hay match, puedes dejarlo nulo o igual al original\n    item.json.pipeline_stage = null;\n  }\n  \n  return item;\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        960,
        380
      ],
      "id": "12353f9a-af2e-4732-9a4b-0a8cd3360329",
      "name": "Encontrar el stage id 2"
    },
    {
      "parameters": {
        "jsCode": "let match = {\n  \"Cuenta que deposito\": {\n    id: \"mPbI3JvvW2tUAXBHXV9n\",\n    key: \"opportunity.cuenta_que_deposito\"\n  },\n  \"Tipo de aplicación\": {\n    id: \"p7lJUWQtkaoRXlVikvXj\",\n    key: \"opportunity.tipo_de_aplicacin\"\n  }\n};\n\nreturn $input.all().map(item => {\n  let customFields = item.json.custom_fields || [];\n\n  let customFieldsFixed = customFields\n    .filter(cf => match[cf.field]) // solo si hay match\n    .map(cf => {\n      return {\n        id: match[cf.field].id,\n        key: match[cf.field].key,\n        field_value: cf.value\n      };\n    });\n\n  item.json.custom_fields_fixed = customFieldsFixed;\n\n  return item;\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1180,
        -20
      ],
      "id": "a16346db-784e-4af6-b718-220aba4f47de",
      "name": "encontrar el custom field2"
    },
    {
      "parameters": {
        "jsCode": "return $json;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2720,
        -20
      ],
      "id": "d8cadc9b-a53d-44fa-8503-a390b8d4a9d5",
      "name": "juntar todas las oportunidades1"
    },
    {
      "parameters": {
        "jsCode": "let match = {\n  \"Cuenta que deposito\": {\n    id: \"mPbI3JvvW2tUAXBHXV9n\",\n    key: \"opportunity.cuenta_que_deposito\"\n  },\n  \"Tipo de aplicación\": {\n    id: \"p7lJUWQtkaoRXlVikvXj\",\n    key: \"opportunity.tipo_de_aplicacin\"\n  }\n};\n\nreturn $input.all().map(item => {\n  let customFields = item.json.custom_fields || [];\n\n  let customFieldsFixed = customFields\n    .filter(cf => match[cf.field]) // solo si hay match\n    .map(cf => {\n      return {\n        id: match[cf.field].id,\n        key: match[cf.field].key,\n        field_value: cf.value\n      };\n    });\n\n  item.json.custom_fields_fixed = customFieldsFixed;\n\n  return item;\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1180,
        780
      ],
      "id": "8819eae4-af59-41fd-8199-533f2ce5f707",
      "name": "encontrar el custom field3"
    },
    {
      "parameters": {
        "jsCode": "return $json;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2720,
        780
      ],
      "id": "c4e1ecef-1d88-4e83-b059-f1bc7f1dc08f",
      "name": "juntar todas las oportunidades2"
    },
    {
      "parameters": {
        "jsCode": "let match = {\n  \"Inicio de proceso - Aus\" : \"10d2a1b1-27a5-432d-ab44-1fba0e0113af\",\n  \"Aplicación a institución - Aus\": \"e3db4d5c-d106-4c72-9188-de7dea8cacc7\",\n  \"Pagos - Aus\": \"bd46e89e-bfea-4af9-bb7a-98af409a5338\",\n  \"COE - Proceso de Visa - Aus\": \"8d0e49ac-838d-4483-afa4-5f76325408fc\",\n  \"Visa Aplicada - Aus\": \"e1b44afc-f9a7-4c32-946a-4e095ba11336\"\n}\n\n// recorrer los items, mirando su pipeline_stage_desc y comparando\nreturn $input.all().map(item => {\n  let desc = item.json.pipeline_stage_desc;\n  \n  if (match[desc]) {\n    item.json.pipeline_stage = match[desc];\n  } else {\n    // si no hay match, puedes dejarlo nulo o igual al original\n    item.json.pipeline_stage = null;\n  }\n  \n  return item;\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        960,
        780
      ],
      "id": "60e08101-2435-4b3a-b275-8bc9342a43e3",
      "name": "Encontrar el stage id 3"
    },
    {
      "parameters": {
        "jsCode": "let match = {\n  \"Cuenta que deposito\": {\n    id: \"mPbI3JvvW2tUAXBHXV9n\",\n    key: \"opportunity.cuenta_que_deposito\"\n  },\n  \"Tipo de aplicación\": {\n    id: \"p7lJUWQtkaoRXlVikvXj\",\n    key: \"opportunity.tipo_de_aplicacin\"\n  }\n};\n\nreturn $input.all().map(item => {\n  let customFields = item.json.custom_fields || [];\n\n  let customFieldsFixed = customFields\n    .filter(cf => match[cf.field]) // solo si hay match\n    .map(cf => {\n      return {\n        id: match[cf.field].id,\n        key: match[cf.field].key,\n        field_value: cf.value\n      };\n    });\n\n  item.json.custom_fields_fixed = customFieldsFixed;\n\n  return item;\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1180,
        1180
      ],
      "id": "9b66638e-bcb5-4bee-b7a1-322fc08e27fa",
      "name": "encontrar el custom field4"
    },
    {
      "parameters": {
        "jsCode": "let match = {\n  \"Inicio Turista - Latam\" : \"45bd7a56-212c-4ba1-8def-0d1670abb26a\",\n  \"Pago Turista - Latam\": \"43954115-2b6f-4fe5-a820-aebedf31f980\",\n  \"Recep documentos Turista - Latam\": \"d9f395ab-88e8-470c-9fcf-3a5a701eb12b\",\n  \"Pagos consulares Turista - Latam\": \"75b73b10-09dc-49f4-a03d-9212cf733e76\",\n  \"Visa Aplicada Turista - Latam\": \"6a24e782-50a0-4151-bec4-b61e1d28a7e4\",\n  \"Agendamiento de citas Turista - Latam\": \"8e2ce017-0a99-4b9b-b586-ba1cedc81a68\"\n}\n\n// recorrer los items, mirando su pipeline_stage_desc y comparando\nreturn $input.all().map(item => {\n  let desc = item.json.pipeline_stage_desc;\n  \n  if (match[desc]) {\n    item.json.pipeline_stage = match[desc];\n  } else {\n    // si no hay match, puedes dejarlo nulo o igual al original\n    item.json.pipeline_stage = null;\n  }\n  \n  return item;\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        960,
        1180
      ],
      "id": "57fdc060-0395-44c5-97f6-e0b841be5d51",
      "name": "Encontrar el stage id 4"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "let url = $json.contact;\nconst parts = url.split(\"/\").filter(Boolean); // elimina los vacíos\nconst id = parts[parts.length - 1]; // último segmento\n\n$json.id_contact = id;\n\nreturn $json;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1400,
        -420
      ],
      "id": "2a481287-b808-4382-9a5a-08aad9e0885d",
      "name": "obtener id contact clientify"
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "match_contacts",
          "mode": "list",
          "cachedResultName": "match_contacts"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "=id_contact_clientify",
              "value": "={{ $json.id_contact }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        1620,
        -420
      ],
      "id": "726f432f-6a8b-45a5-97f6-e655eeea401a",
      "name": "Select rows from a table",
      "credentials": {
        "postgres": {
          "id": "tfjc18K49daMASdp",
          "name": "Base de datos APIS"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "45fb38c8-63d7-4f3d-9774-6c277710022c",
              "leftValue": "={{ $json.id_contact_ropofy }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1840,
        -420
      ],
      "id": "2617d6d4-0670-404a-82bb-40cc0e68f292",
      "name": "If"
    },
    {
      "parameters": {
        "operation": "get",
        "contactId": "={{ $json.id_contact_ropofy }}",
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        -520
      ],
      "id": "f5e8620b-6c67-49f4-b0f0-453b9c2ab386",
      "name": "Get a contact",
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "ulmX2nODHk0Od8vs",
          "name": "Blue studies - migraciones"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "limit": 1,
        "delayPagination": 500,
        "filters": {
          "query": "={{ $json.contact_phone }}"
        },
        "options": {},
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        80
      ],
      "id": "5c67d7d5-6a4b-49b1-b5c6-40f7332fcfe9",
      "name": "Get many contacts",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "9EZZ771fViKZkfUg",
          "name": "Blue studies - App ropoflow"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "let url = $json.contact;\n\nif(url){\n  const parts = url.split(\"/\").filter(Boolean); // elimina los vacíos\n  const id = parts[parts.length - 1]; // último segmento\n  \n  $json.id_contact = id;\n  \n  return $json;\n}else{\n  $json.id_contact = \"000000\";\n  return $json;\n}\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1400,
        -20
      ],
      "id": "13f8dade-4093-4170-b4a9-116dea58e471",
      "name": "obtener id contact clientify1"
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "match_contacts",
          "mode": "list",
          "cachedResultName": "match_contacts"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "=id_contact_clientify",
              "value": "={{ $json.id_contact }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        1620,
        -20
      ],
      "id": "8eac3a61-3807-4589-8cc2-11a2c734e51f",
      "name": "Select rows from a table1",
      "credentials": {
        "postgres": {
          "id": "tfjc18K49daMASdp",
          "name": "Base de datos APIS"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "45fb38c8-63d7-4f3d-9774-6c277710022c",
              "leftValue": "={{ $json.id_contact_ropofy }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1840,
        -20
      ],
      "id": "6727550c-120e-4c71-999d-402ea9eff66e",
      "name": "If1"
    },
    {
      "parameters": {
        "operation": "get",
        "contactId": "={{ $json.id_contact_ropofy }}",
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        -120
      ],
      "id": "ad5ae3eb-b5a7-42b4-a911-fec7191881e0",
      "name": "Get a contact1",
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "ulmX2nODHk0Od8vs",
          "name": "Blue studies - migraciones"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "limit": 1,
        "delayPagination": 500,
        "filters": {
          "query": "={{ $json.contact_phone }}"
        },
        "options": {},
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        480
      ],
      "id": "55ed19f4-5f0a-423c-8d9f-98059c4fc964",
      "name": "Get many contacts13",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "9EZZ771fViKZkfUg",
          "name": "Blue studies - App ropoflow"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "let url = $json.contact;\n\nif(url){\n  const parts = url.split(\"/\").filter(Boolean); // elimina los vacíos\n  const id = parts[parts.length - 1]; // último segmento\n  \n  $json.id_contact = id;\n  \n  return $json;\n}else{\n  $json.id_contact = \"000000\";\n  return $json;\n}\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1400,
        380
      ],
      "id": "0ca801b0-c9d6-47d6-9c1f-d23e629f8153",
      "name": "obtener id contact clientify2"
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "match_contacts",
          "mode": "list",
          "cachedResultName": "match_contacts"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "=id_contact_clientify",
              "value": "={{ $json.id_contact }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        1620,
        380
      ],
      "id": "75569307-2b24-484c-a8b4-d9e34c6f0899",
      "name": "Select rows from a table2",
      "credentials": {
        "postgres": {
          "id": "tfjc18K49daMASdp",
          "name": "Base de datos APIS"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "45fb38c8-63d7-4f3d-9774-6c277710022c",
              "leftValue": "={{ $json.id_contact_ropofy }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1840,
        380
      ],
      "id": "0a470095-4e7f-4c98-ba05-6516b447aa50",
      "name": "If2"
    },
    {
      "parameters": {
        "operation": "get",
        "contactId": "={{ $json.id_contact_ropofy }}",
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        280
      ],
      "id": "30812161-f181-4df4-9310-4c9bf6e393bf",
      "name": "Get a contact2",
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "ulmX2nODHk0Od8vs",
          "name": "Blue studies - migraciones"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "limit": 1,
        "delayPagination": 500,
        "filters": {
          "query": "={{ $json.contact_phone }}"
        },
        "options": {},
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        880
      ],
      "id": "255cf061-bbf0-47d8-86c4-6e539e5fc0d0",
      "name": "Get many contacts14",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "9EZZ771fViKZkfUg",
          "name": "Blue studies - App ropoflow"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "let url = $json.contact;\n\nif(url){\n  const parts = url.split(\"/\").filter(Boolean); // elimina los vacíos\n  const id = parts[parts.length - 1]; // último segmento\n  \n  $json.id_contact = id;\n  \n  return $json;\n}else{\n  $json.id_contact = \"000000\";\n  return $json;\n}\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1400,
        780
      ],
      "id": "dc053579-4503-4317-8906-1a536b6c0ea0",
      "name": "obtener id contact clientify3"
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "match_contacts",
          "mode": "list",
          "cachedResultName": "match_contacts"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "=id_contact_clientify",
              "value": "={{ $json.id_contact }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        1620,
        780
      ],
      "id": "73af97eb-490d-469d-a357-b629bdc501c1",
      "name": "Select rows from a table3",
      "credentials": {
        "postgres": {
          "id": "tfjc18K49daMASdp",
          "name": "Base de datos APIS"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "45fb38c8-63d7-4f3d-9774-6c277710022c",
              "leftValue": "={{ $json.id_contact_ropofy }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1840,
        780
      ],
      "id": "1003b907-8e29-48e1-8606-1013dfc9f011",
      "name": "If3"
    },
    {
      "parameters": {
        "operation": "get",
        "contactId": "={{ $json.id_contact_ropofy }}",
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        680
      ],
      "id": "ddb2673b-617d-46c4-a032-4a99ab26c866",
      "name": "Get a contact3",
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "ulmX2nODHk0Od8vs",
          "name": "Blue studies - migraciones"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "limit": 1,
        "delayPagination": 500,
        "filters": {
          "query": "={{ $json.contact_phone }}"
        },
        "options": {},
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        1280
      ],
      "id": "5bae2bc8-4adc-4022-9c79-c1321ea59bbf",
      "name": "Get many contacts15",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "9EZZ771fViKZkfUg",
          "name": "Blue studies - App ropoflow"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "let url = $json.contact;\n\nif(url){\n  const parts = url.split(\"/\").filter(Boolean); // elimina los vacíos\n  const id = parts[parts.length - 1]; // último segmento\n  \n  $json.id_contact = id;\n  \n  return $json;\n}else{\n  $json.id_contact = \"000000\";\n  return $json;\n}\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1400,
        1180
      ],
      "id": "6c6156f3-c888-460c-9bc9-71acdedef004",
      "name": "obtener id contact clientify4"
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "match_contacts",
          "mode": "list",
          "cachedResultName": "match_contacts"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "=id_contact_clientify",
              "value": "={{ $json.id_contact }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        1620,
        1180
      ],
      "id": "8515788c-ed5f-4814-b0d8-144dbf077b1d",
      "name": "Select rows from a table4",
      "credentials": {
        "postgres": {
          "id": "tfjc18K49daMASdp",
          "name": "Base de datos APIS"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "45fb38c8-63d7-4f3d-9774-6c277710022c",
              "leftValue": "={{ $json.id_contact_ropofy }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1840,
        1180
      ],
      "id": "3739b3ac-5318-4bc3-b79d-e83782f63c01",
      "name": "If4"
    },
    {
      "parameters": {
        "operation": "get",
        "contactId": "={{ $json.id_contact_ropofy }}",
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        1080
      ],
      "id": "988cdd26-ac84-410c-8c9f-065300d0e7da",
      "name": "Get a contact4",
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "ulmX2nODHk0Od8vs",
          "name": "Blue studies - migraciones"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "return $json;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2720,
        1180
      ],
      "id": "c1bd3148-a60f-49a5-a0d4-7ad598f89865",
      "name": "juntar todas las oportunidades4"
    },
    {
      "parameters": {
        "jsCode": "let match = {\n  \"Cuenta que deposito\": {\n    id: \"mPbI3JvvW2tUAXBHXV9n\",\n    key: \"opportunity.cuenta_que_deposito\"\n  },\n  \"Tipo de aplicación\": {\n    id: \"p7lJUWQtkaoRXlVikvXj\",\n    key: \"opportunity.tipo_de_aplicacin\"\n  }\n};\n\nreturn $input.all().map(item => {\n  let customFields = item.json.custom_fields || [];\n\n  let customFieldsFixed = customFields\n    .filter(cf => match[cf.field]) // solo si hay match\n    .map(cf => {\n      return {\n        id: match[cf.field].id,\n        key: match[cf.field].key,\n        field_value: cf.value\n      };\n    });\n\n  item.json.custom_fields_fixed = customFieldsFixed;\n\n  return item;\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1180,
        1580
      ],
      "id": "fcd67c73-81b3-4c09-8c89-9b04fbbddaa6",
      "name": "encontrar el custom field5"
    },
    {
      "parameters": {
        "operation": "getAll",
        "limit": 1,
        "delayPagination": 500,
        "filters": {
          "query": "={{ $json.contact_phone }}"
        },
        "options": {},
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        1680
      ],
      "id": "e594edaf-c864-4d0f-8f32-8bac787c14b7",
      "name": "Get many contacts16",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "9EZZ771fViKZkfUg",
          "name": "Blue studies - App ropoflow"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "let url = $json.contact;\n\nif(url){\n  const parts = url.split(\"/\").filter(Boolean); // elimina los vacíos\n  const id = parts[parts.length - 1]; // último segmento\n  \n  $json.id_contact = id;\n  \n  return $json;\n}else{\n  $json.id_contact = \"000000\";\n  return $json;\n}\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1400,
        1580
      ],
      "id": "1bdf26a2-f63b-446d-8651-554bae7ddb8e",
      "name": "obtener id contact clientify5"
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "match_contacts",
          "mode": "list",
          "cachedResultName": "match_contacts"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "=id_contact_clientify",
              "value": "={{ $json.id_contact }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        1620,
        1580
      ],
      "id": "75151571-262c-4f56-aee7-e0c12e53a3d6",
      "name": "Select rows from a table5",
      "credentials": {
        "postgres": {
          "id": "tfjc18K49daMASdp",
          "name": "Base de datos APIS"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "45fb38c8-63d7-4f3d-9774-6c277710022c",
              "leftValue": "={{ $json.id_contact_ropofy }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1840,
        1580
      ],
      "id": "7e912e25-a0d5-4726-adbd-d9899e1674a0",
      "name": "If5"
    },
    {
      "parameters": {
        "operation": "get",
        "contactId": "={{ $json.id_contact_ropofy }}",
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        1480
      ],
      "id": "87d5ee75-ff5c-4cae-94e5-a53fe74fe5de",
      "name": "Get a contact5",
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "ulmX2nODHk0Od8vs",
          "name": "Blue studies - migraciones"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "return $json;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2720,
        1580
      ],
      "id": "5a38392e-69af-4d2c-81b3-8472cb2787ea",
      "name": "juntar todas las oportunidades5"
    },
    {
      "parameters": {
        "jsCode": "let match = {\n  \"Pre - Departure\" : \"8da90744-95c9-4995-8a51-4eb284c1e5c6\",\n  \"Welcome session\": \"8431abc7-d490-4c1a-84ce-ac9e0826eda7\",\n  \"Seguimiento llegada destino\": \"62e1eb59-3dc7-4d37-b27d-b867e9170cc4\",\n  \"1er Seguimiento - FORMULARIO\": \"433b3505-6afb-423a-b261-aacc6fdeaa67\",\n  \"2do Seguimiento\": \"ff577e75-b048-4b44-8e63-516b20384462\",\n  \"3er Seguimiento\": \"ce8d3916-3b82-44d9-b17d-9d9a400edccf\",\n  \"4to Seguimiento\": \"7ec8f6c6-fddd-4b51-8f62-6787a1afaf85\"\n}\n\n// recorrer los items, mirando su pipeline_stage_desc y comparando\nreturn $input.all().map(item => {\n  let desc = item.json.pipeline_stage_desc;\n  \n  if (match[desc]) {\n    item.json.pipeline_stage = match[desc];\n  } else {\n    // si no hay match, puedes dejarlo nulo o igual al original\n    item.json.pipeline_stage = null;\n  }\n  \n  return item;\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        960,
        1580
      ],
      "id": "14b8e796-52a4-43cd-bd12-17f36c32f5b4",
      "name": "Encontrar el stage id 5"
    },
    {
      "parameters": {
        "jsCode": "let match = {\n  \"Cuenta que deposito\": {\n    id: \"mPbI3JvvW2tUAXBHXV9n\",\n    key: \"opportunity.cuenta_que_deposito\"\n  },\n  \"Tipo de aplicación\": {\n    id: \"p7lJUWQtkaoRXlVikvXj\",\n    key: \"opportunity.tipo_de_aplicacin\"\n  }\n};\n\nreturn $input.all().map(item => {\n  let customFields = item.json.custom_fields || [];\n\n  let customFieldsFixed = customFields\n    .filter(cf => match[cf.field]) // solo si hay match\n    .map(cf => {\n      return {\n        id: match[cf.field].id,\n        key: match[cf.field].key,\n        field_value: cf.value\n      };\n    });\n\n  item.json.custom_fields_fixed = customFieldsFixed;\n\n  return item;\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1180,
        1980
      ],
      "id": "ba327026-c7f1-46ad-a589-d82f81a5ebb4",
      "name": "encontrar el custom field6"
    },
    {
      "parameters": {
        "operation": "getAll",
        "limit": 1,
        "delayPagination": 500,
        "filters": {
          "query": "={{ $json.contact_phone }}"
        },
        "options": {},
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        2080
      ],
      "id": "d964ea7b-4c32-4db1-859b-f6597969f2d7",
      "name": "Get many contacts17",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "9EZZ771fViKZkfUg",
          "name": "Blue studies - App ropoflow"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "let url = $json.contact;\n\nif(url){\n  const parts = url.split(\"/\").filter(Boolean); // elimina los vacíos\n  const id = parts[parts.length - 1]; // último segmento\n  \n  $json.id_contact = id;\n  \n  return $json;\n}else{\n  $json.id_contact = \"000000\";\n  return $json;\n}\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1400,
        1980
      ],
      "id": "69916249-b70b-4b21-a917-50e8c4fa5e0f",
      "name": "obtener id contact clientify6"
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "match_contacts",
          "mode": "list",
          "cachedResultName": "match_contacts"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "=id_contact_clientify",
              "value": "={{ $json.id_contact }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        1620,
        1980
      ],
      "id": "37e0162a-8ebf-481f-9a5b-389e8b1bb49a",
      "name": "Select rows from a table6",
      "credentials": {
        "postgres": {
          "id": "tfjc18K49daMASdp",
          "name": "Base de datos APIS"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "45fb38c8-63d7-4f3d-9774-6c277710022c",
              "leftValue": "={{ $json.id_contact_ropofy }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1840,
        1980
      ],
      "id": "7199c17d-a55d-48c4-86a5-57029bea0ba2",
      "name": "If6"
    },
    {
      "parameters": {
        "operation": "get",
        "contactId": "={{ $json.id_contact_ropofy }}",
        "requestOptions": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 500
            }
          }
        }
      },
      "type": "n8n-nodes-base.ropofy",
      "typeVersion": 2,
      "position": [
        2060,
        1880
      ],
      "id": "960b2911-a8af-4e3e-bfb0-ae6264408111",
      "name": "Get a contact6",
      "credentials": {
        "ropofyOAuth2Api": {
          "id": "ulmX2nODHk0Od8vs",
          "name": "Blue studies - migraciones"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "return $json;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2720,
        1980
      ],
      "id": "996d87e9-5722-41fe-b988-8693bf6cbde9",
      "name": "juntar todas las oportunidades6"
    },
    {
      "parameters": {
        "jsCode": "let match = {\n  \"Not use 1\" : \"92447d20-5ae5-43a4-b8e7-bc1cb1efa8b1\",\n}\n\n// recorrer los items, mirando su pipeline_stage_desc y comparando\nreturn $input.all().map(item => {\n  let desc = item.json.pipeline_stage_desc;\n  \n  if (match[desc]) {\n    item.json.pipeline_stage = match[desc];\n  } else {\n    // si no hay match, puedes dejarlo nulo o igual al original\n    item.json.pipeline_stage = null;\n  }\n  \n  return item;\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        960,
        1980
      ],
      "id": "4583ec07-7750-43fd-a244-e4eeeef0f22a",
      "name": "Encontrar el stage id 6"
    },
    {
      "parameters": {
        "jsCode": "return $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3540,
        860
      ],
      "id": "69f57567-a25a-4127-aa56-40224dbe4ab6",
      "name": "Code"
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "system_ropofy_locations",
          "mode": "list",
          "cachedResultName": "system_ropofy_locations"
        },
        "limit": 1,
        "where": {
          "values": [
            {
              "column": "location_id",
              "value": "ygtUsqeG906cD9c4piwT"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -440,
        980
      ],
      "id": "5158012d-750d-4cac-a323-bf4a0e304cec",
      "name": "obtener token",
      "credentials": {
        "postgres": {
          "id": "tfjc18K49daMASdp",
          "name": "Base de datos APIS"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://services.leadconnectorhq.com/opportunities/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "={{ $('obtener token').item.json.token }}"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"pipelineId\": \"{{ $('Encontrar el stage id 2').item.json.pipeline }}\",\n  \"locationId\": \"{{ $('obtener token').item.json.location_id }}\",\n  \"name\": \"{{ $('Admin latam').item.json.name }} - CLIENTIFY\",\n  \"pipelineStageId\": \"{{ $('Encontrar el stage id 2').item.json.pipeline_stage }}\",\n  \"status\": \"{{ $('Encontrar el stage id 2').first().json.status == 4 ? 'lost' : $('Encontrar el stage id 2').first().json.status == 3 ? 'won' : $('Encontrar el stage id 2').first().json.status == 2 ? 'abandoned' : $('Encontrar el stage id 2').first().json.status == 1 ? 'open' : 'Desconocido' }}\",\n  \"contactId\": \"{{ $json.id }}\",\n  \"monetaryValue\": {{ $('Admin latam').item.json.amount.toNumber().round() }},\n  \"customFields\": {{ JSON.stringify(Array.isArray($('encontrar el custom field1').item.json.custom_fields_fixed) ? $('encontrar el custom field1').item.json.custom_fields_fixed : []) }}\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2400,
        380
      ],
      "id": "4762102d-33fb-48fd-82e1-3376b6aee870",
      "name": "guardar oportunidad",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://services.leadconnectorhq.com/opportunities/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "={{ $('obtener token').item.json.token }}"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"pipelineId\": \"{{ $('Telemercadeo').item.json.pipeline }}\",\n  \"locationId\": \"{{ $('obtener token').item.json.location_id }}\",\n  \"name\": \"{{ $json.firstName }} - CLIENTIFY\",\n  \"pipelineStageId\": \"44ff8a36-886f-40b6-8861-d9b494cb3c70\",\n  \"status\": \"{{ $('Edit Fields').first().json.status == 4 ? 'lost' : $('Edit Fields').first().json.status == 3 ? 'won' : $('Edit Fields').first().json.status == 2 ? 'abandoned' : $('Edit Fields').first().json.status == 1 ? 'open' : 'open' }}\",\n  \"contactId\": \"{{ $json.id }}\",\n  \"monetaryValue\": {{ $('Edit Fields').item.json.amount.toNumber().round() }},\n  \"customFields\": {{ JSON.stringify(Array.isArray($('encontrar el custom field2').item.json.custom_fields_fixed) ? $('encontrar el custom field2').item.json.custom_fields_fixed : []) }}\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2400,
        -20
      ],
      "id": "76857658-3540-4d7b-a9f5-8f9445d0cc6b",
      "name": "guardar oportunidad1",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://services.leadconnectorhq.com/opportunities/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "={{ $('obtener token').item.json.token }}"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"pipelineId\": \"{{ $('Comercial').item.json.pipeline }}\",\n  \"locationId\": \"{{ $('obtener token').item.json.location_id }}\",\n  \"name\": \"{{ $('Comercial').item.name}} - CLIENTIFY\",\n  \"pipelineStageId\": \"{{ $('Encontrar el stage id').item.pipeline_stage}}\",\n  \"status\": \"{{ $('Encontrar el stage id').first().json.status == 4 ? 'lost' : $('Encontrar el stage id').first().json.status == 3 ? 'won' : $('Encontrar el stage id').first().json.status == 2 ? 'abandoned' : $('Encontrar el stage id').first().json.status == 1 ? 'open' : 'open' }}\",\n  \"contactId\": \"{{ $json.id }}\",\n  \"monetaryValue\": {{ $('Encontrar el stage id').item.json.amount.toNumber().round() }},\n  \"customFields\": {{ JSON.stringify(Array.isArray($('encontrar el custom field').item.json.custom_fields_fixed) ? $('encontrar el custom field').item.json.custom_fields_fixed : []) }}\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2400,
        -420
      ],
      "id": "b6eec42c-ba86-423e-b951-fc61a1656780",
      "name": "guardar oportunidad2",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://services.leadconnectorhq.com/opportunities/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "={{ $('obtener token').item.json.token }}"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"pipelineId\": \"{{ $('Encontrar el stage id 3').item.json.pipeline }}\",\n  \"locationId\": \"{{ $('obtener token').item.json.location_id }}\",\n  \"name\": \"{{ $('Encontrar el stage id 3').item.json.name }} - CLIENTIFY\",\n  \"pipelineStageId\": \"{{ $('Encontrar el stage id 3').item.json.pipeline_stage }}\",\n  \"status\": \"{{ $('Encontrar el stage id 3').first().json.status == 4 ? 'lost' : $('Encontrar el stage id 3').first().json.status == 3 ? 'won' : $('Encontrar el stage id 3').first().json.status == 2 ? 'abandoned' : $('Encontrar el stage id 3').first().json.status == 1 ? 'open' : 'Desconocido' }}\",\n  \"contactId\": \"{{ $json.id }}\",\n  \"monetaryValue\": {{ $('encontrar el custom field3').item.json.amount.toNumber().round() }},\n  \"customFields\": {{ JSON.stringify(Array.isArray($('encontrar el custom field3').item.json.custom_fields_fixed) ? $('encontrar el custom field3').item.json.custom_fields_fixed : []) }}\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2400,
        780
      ],
      "id": "9a8565eb-d8a9-4cf4-a10b-66115d6ef999",
      "name": "guardar oportunidad3",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://services.leadconnectorhq.com/opportunities/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "={{ $('obtener token').item.json.token }}"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"pipelineId\": \"{{ $('obtener id contact clientify4').item.json.pipeline }}\",\n  \"locationId\": \"{{ $('obtener token').item.json.location_id }}\",\n  \"name\": \"{{ $('obtener id contact clientify4').item.json.name }} - CLIENTIFY\",\n  \"pipelineStageId\": \"{{ $('obtener id contact clientify4').item.json.pipeline_stage }}\",\n  \"status\": \"{{ $('Encontrar el stage id 4').first().json.status == 4 ? 'lost' : $('Encontrar el stage id 4').first().json.status == 3 ? 'won' : $('Encontrar el stage id 4').first().json.status == 2 ? 'abandoned' : $('Encontrar el stage id 4').first().json.status == 1 ? 'open' : 'Desconocido' }}\",\n  \"contactId\": \"{{ $json.id }}\",\n  \"monetaryValue\": {{ $('Encontrar el stage id 4').item.json.amount.toNumber().round() }},\n  \"customFields\": {{ JSON.stringify(Array.isArray($('Encontrar el stage id 4').item.json.custom_fields_fixed) ? $('Encontrar el stage id 4').item.json.custom_fields_fixed : []) }}\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2400,
        1180
      ],
      "id": "8d91cee6-244a-48e7-be7b-826aee77537e",
      "name": "guardar oportunidad4",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://services.leadconnectorhq.com/opportunities/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "={{ $('obtener token').item.json.token }}"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"pipelineId\": \"{{ $('obtener id contact clientify5').item.json.pipeline }}\",\n  \"locationId\": \"{{ $('obtener token').item.json.location_id }}\",\n  \"name\": \"{{ $('obtener id contact clientify5').item.json.name }} - CLIENTIFY\",\n  \"pipelineStageId\": \"{{ $('obtener id contact clientify5').item.json.pipeline_stage }}\",\n  \"status\": \"{{ $('Encontrar el stage id 5').first().json.status == 4 ? 'lost' : $('Encontrar el stage id 5').first().json.status == 3 ? 'won' : $('Encontrar el stage id 5').first().json.status == 2 ? 'abandoned' : $('Encontrar el stage id 5').first().json.status == 1 ? 'open' : 'Desconocido' }}\",\n  \"contactId\": \"{{ $json.id }}\",\n  \"monetaryValue\": {{ $('Encontrar el stage id 5').item.json.amount.toNumber().round() }},\n  \"customFields\": {{ JSON.stringify(Array.isArray($('encontrar el custom field5').item.json.custom_fields_fixed) ? $('encontrar el custom field5').item.json.custom_fields_fixed : []) }}\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2400,
        1580
      ],
      "id": "00e88c1f-a61b-411e-8899-12a78175a680",
      "name": "guardar oportunidad5",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://services.leadconnectorhq.com/opportunities/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "={{ $('obtener token').item.json.token }}"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"pipelineId\": \"{{ $('obtener id contact clientify6').item.json.pipeline }}\",\n  \"locationId\": \"{{ $('obtener token').item.json.location_id }}\",\n  \"name\": \"{{ $('obtener id contact clientify6').item.json.name }} - CLIENTIFY\",\n  \"pipelineStageId\": \"{{ $('obtener id contact clientify6').item.json.pipeline_stage }}\",\n  \"status\": \"{{ $('Encontrar el stage id 6').first().json.status == 4 ? 'lost' : $('Encontrar el stage id 6').first().json.status == 3 ? 'won' : $('Encontrar el stage id 6').first().json.status == 2 ? 'abandoned' : $('Encontrar el stage id 6').first().json.status == 1 ? 'open' : 'Desconocido' }}\",\n  \"contactId\": \"{{ $json.id }}\",\n  \"monetaryValue\": {{ $('Encontrar el stage id 6').item.json.amount.toNumber().round() }},\n  \"customFields\": {{ JSON.stringify(Array.isArray($('encontrar el custom field6').item.json.custom_fields_fixed) ? $('encontrar el custom field6').item.json.custom_fields_fixed : []) }}\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2400,
        1980
      ],
      "id": "6c46e591-20df-44af-b0de-eb8e4c2fdc56",
      "name": "guardar oportunidad6",
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "onError": "continueErrorOutput"
    }
  ],
  "pinData": {},
  "repo_name": "ropoflow_workflows_backup",
  "repo_owner": "sebastianOrtizRopofy",
  "repo_path": "ropoflow_workflows_backup",
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-09-27T03:30:57.458Z",
  "versionId": "2cf5f152-0377-4f88-8e56-b8e0024c74f8"
}